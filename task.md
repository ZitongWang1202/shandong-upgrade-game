
cd shandong-upgrade-game
cd shandong-upgrade-game/server && npm run dev
cd shandong-upgrade-game && npm start

创建房间
出现界面 玩法 局数 模式 
创建房间 加入 返回到游戏大厅

游戏界面

未进入游戏之前
玩家进入房间 自己可以点击准备 准备后可以点击取消
其他玩家状态显示 没有玩家则显示空位 入座后显示玩家ID 准备后显示准备
如果四个人都准备 则开始游戏


进入游戏后分为发牌阶段和出牌阶段

发牌阶段
游戏用两幅带大小鬼的扑克牌
首先随机留出四张牌作为底牌 
每一秒给每一位玩家发一张牌 直到发完为止 发牌后显示在玩家面前 排序按照本轮的牌大小来排序 右边的牌会遮盖住左边的牌一部分来节省空间 只需要完整显示牌左边数字花色即可
大小王**5**，**3**，**2**为常主，以打 **10** 为例，主牌单张大小顺序为：'
4 < 6 < 7 < 8 < 9 < J < Q < K < A < **副2** < **主2** < **副3** < **主3** < **副5** < **主5** < 副10 < 主10 < 小王 < 大王
单张**副牌**的大小顺序为：
4 < 6 < 7 < 8 < 9 < J < Q < K < A
则发到手上的牌显示从右往左 从大到小 先是常主牌从大到小 然后是副牌从大到小 花色按照 ♥ ♠ ♦ ♣ 顺序排列




亮主时，需要构成**一王带一对**（例如 ♠99小王），先亮牌的定主。
若后来有人亮**一对王带一对**（例如 ♣44大王大王），则可以抢夺定主权。
若后来有人**一王带连对**（例如 ♦6677大王），则可以**粘牌**，把领先定主的三张牌拿走，回一个大于A的主和两个副牌，但不能抢夺定主权。
四张底牌，由定主庄家的对门，或者定主闲家的下一位扣底。亮主时除大王小王之外的牌需**牌面朝下**，直到庄家扣完底后再翻开。庄家由于不知道亮主花色，有可能将主牌扣入底牌中，增添了运气成分。
如果闲家在摸牌阶段不亮主，且庄家亮主失败，则闲家直接升 3 级进入下一局，或上台打闲家级别并开始亮主。

叫主阶段

@GameLayout.js 先从修改客户端开始 哪里是检查发到手的牌中是否有大小王的函数
我想要实现 发到手的牌中有大小王时 对应的按钮才亮起 才可以选中 
我想让对子的选择也和王一样 一开始四个图标都是灰的  当对应的花色有对子时 亮起 选中对子之后显示选中的对子
我需要在每发一张牌时 手牌显示都是正确的排序 已经有排序函数了

@GameLayout.js @index.js 在叫主 反主 加固这些阶段结束之后 进入粘牌阶段 此时除了最后叫上主的玩家 其他玩家检查自己的手牌是否有一张王和一个连对 比如 大王+红桃6677 如果有则可以点击 粘牌按键 谁先点击 则其他玩家不能在点击粘牌 点击完后可以看到叫主玩家 用来叫主的王和一对牌（如果是反主 则看到其中一张王） 然后 从自己的手牌 选择一张常主 和两张和叫主的牌相同花色的牌 这三张牌和叫主玩家的三张牌交换

出牌阶段

1. 实现 isValidFollow: GameLayout.js 中的 isValidFollow 函数目前只是一个检查牌数的占位符。这是剩下的最关键的部分。你需要仔细地将 rule5.js 和 rule7.js 中的规则转换为该函数内的 JavaScript 逻辑。这包括：
~识别领出的花色和牌型。
~检查玩家手牌中是否有领出的花色。
~强制执行“必须跟同花色”的规则。
~强制执行“必须跟同牌型”的规则（例如，如果可能，对子必须跟对子）。
~处理垫牌。
~处理用主牌毙牌（杀牌），并进行正确的牌型匹配。
~处理用更大的主牌超吃，通过比较大小。
~你很可能需要辅助函数，如 getPatternDetails(cards, mainSuit, commonMain)（获取牌型细节）和健壮的牌等级比较函数 (getCardRank)。
2. 实现 determineRoundWinner: 服务器端的占位符需要正确的逻辑，以根据打出的牌、是否毙牌和牌的大小来决定谁赢得这一轮。赢家获得下一轮的领出权。
3. 服务器端验证: 在服务器的 playCards 处理器中添加更健壮的验证，以防止作弊或错误，应镜像客户端的 isValidFollow 逻辑。
4. 优化 cardSelectionValidator (可选): 通过在 GameLayout.js 的 gaming 验证器中添加检查，改善跟牌玩家的实时选牌体验。
5. 测试: 全面测试各种场景：跟同花色、没有同花色时垫牌/毙牌、主牌吃副牌、主牌吃主牌（超吃）、跟不同的牌型（对子、连对）。







游戏流程



players
room
gamestate

io.to(roomId).emit('gameStart');